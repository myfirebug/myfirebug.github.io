"use strict";(self.webpackChunklarge_screen_configuration=self.webpackChunklarge_screen_configuration||[]).push([[8372,780,6739],{98372:function(e,n,l){l.r(n);var t=l(67294),i=l(89250),a=l(4214),d=l(50780),o=l(46020),u=l.n(o),r=(l(24404),l(240)),g=l(30076),c=l(75735),v=l(72389),E=l(5676),s=l(83309);n.default=()=>{var e,n,l,o,p,I,m,f,w,T,D,y,_,V,M,h,G,C,L,b,S,F,O,Y,W;let N=(0,i.TH)();const[k,P]=(0,t.useReducer)(d.pageReducer,d.initialState),[,A]=(0,t.useState)(!1),[,R]=(0,t.useState)(!0);(0,t.useEffect)((()=>{new URLSearchParams(N.search).size||P({type:"PAGE",data:{name:"未命名页面",id:"",createTime:"",count:0,pageId:(0,r.M8)(),screenRatio:"4*4",widgets:[],configuration:{configureValue:{...g.MP.configureValue}}}})}),[N]);const x=(0,t.useMemo)((()=>{let e=[];return null!=k&&k.pageId?(e=["layer","page"],e=null!=k&&k.widgetId?null!=k&&k.elementId?["layer","element","widget","page","data"]:["layer","widget","page","data"]:["layer","page"]):e=["layer"],e}),[null==k?void 0:k.elementId,null==k?void 0:k.pageId,null==k?void 0:k.widgetId]),z=(0,t.useCallback)(((e,n,l)=>{switch(e){case"widget":return void((null==k?void 0:k.widgetId)!==n&&P({type:"SELECT_WIDGET",widgetId:n}));case"element":return void((null==k?void 0:k.elementId)!==n&&P({type:"SELECT_ELEMENT",widgetId:l,elementId:n}))}}),[null==k?void 0:k.elementId,null==k?void 0:k.widgetId]),Z=(0,t.useMemo)((()=>{var e;return null==k||null===(e=k.page)||void 0===e?void 0:e.widgets.find((e=>(null==k?void 0:k.widgetId)&&e.widgetId===(null==k?void 0:k.widgetId)))}),[null==k||null===(e=k.page)||void 0===e?void 0:e.widgets,null==k?void 0:k.widgetId]),H=(0,t.useMemo)((()=>null==Z?void 0:Z.elements.find((e=>(null==k?void 0:k.elementId)&&e.elementId===(null==k?void 0:k.elementId)))),[null==Z?void 0:Z.elements,null==k?void 0:k.elementId]),J=(0,t.useCallback)((e=>{var n,l,i,d;return e.element&&c.Z[(0,r.fm)(e.element)]?t.createElement(t.Fragment,null,(null==k?void 0:k.elementId)===e.elementId&&"element"===(null==k?void 0:k.selectedType)?t.createElement(a.k1,null):null,t.createElement(c.Z[(0,r.fm)(e.element)],{options:e.configuration.configureValue,data:null===(n=e.configuration)||void 0===n||null===(l=n.dataValue)||void 0===l?void 0:l.mock,field:null===(i=e.configuration)||void 0===i||null===(d=i.dataValue)||void 0===d?void 0:d.field})):t.createElement("div",null,"你访问的组件不存在请联系售后人员")}),[null==k?void 0:k.elementId,null==k?void 0:k.selectedType]),K=(0,t.useCallback)((e=>t.createElement(t.Fragment,null,(null==k?void 0:k.widgetId)===e.widgetId&&null!=k&&k.selectedType&&["widget","data"].includes(null==k?void 0:k.selectedType)?t.createElement(a.k1,null):null,t.createElement(E.Z,{data:e,header:t.createElement(v.Z,{datas:(null==e?void 0:e.elements.filter((e=>"header"===e.position)))||[],column:s.yt,row:s.GK,gap:s.gq,render:J,isDroppable:!0,isResizable:!0,staticed:!0}),body:t.createElement(v.Z,{datas:(null==e?void 0:e.elements.filter((e=>"body"===e.position)))||[],column:s.UK,row:s.XR,gap:s.hU,render:J,isDroppable:!0,isResizable:!0,staticed:!0})}))),[null==k?void 0:k.selectedType,null==k?void 0:k.widgetId,J]),U=(0,t.useCallback)(((e,n,l)=>{var t;P({type:"ADD_WIDGET",data:{...n,widgetId:(0,r.M8)(),x:e.x,y:e.y,position:l,elements:null==n||null===(t=n.elements)||void 0===t?void 0:t.map((e=>({...e,elementId:(0,r.M8)()})))}})}),[]),$=(0,t.useCallback)((e=>{P({type:"MODIFY_WIDGET",data:{x:e.x,y:e.y,widgetId:e.i}})}),[]),j=(0,t.useCallback)((e=>{P({type:"MODIFY_WIDGET",data:{row:e.w,column:e.h,widgetId:e.i}})}),[]),B=(0,t.useCallback)((e=>{P({type:"DELETE_WIDGET",id:e.widgetId})}),[]),X=(0,t.useCallback)((e=>{P({type:"SELECTED_TYPE",data:e})}),[]);return t.createElement("div",{className:"cms-config-layout"},t.createElement(a.G6,{name:null==k||null===(n=k.page)||void 0===n?void 0:n.name,pageType:"page",modifyNameSuccessHander:e=>{P({type:"MODIFY_PAGE",data:{name:e}})},previewHandler:()=>A(!0),publishHandler:()=>{R(!1),setTimeout((()=>{u()(document.getElementById("js_page"),{allowTaint:!0,scale:.5,backgroundColor:"rgb(9, 5, 72)"}).then((e=>{}))}),10)}}),t.createElement("div",{className:"cms-config-layout__content"},t.createElement(a.Gd,{navs:["widget"],render:e=>"widget"===e?t.createElement(a.zc,null):null}),t.createElement(a.JE,null,t.createElement("div",{style:{position:"relative",width:`${null==k||null===(l=k.page)||void 0===l||null===(o=l.configuration)||void 0===o||null===(p=o.configureValue)||void 0===p?void 0:p.pageConfigWidth}px`,height:`${null==k||null===(I=k.page)||void 0===I||null===(m=I.configuration)||void 0===m||null===(f=m.configureValue)||void 0===f?void 0:f.pageConfigHeight}px`},id:"js_page"},t.createElement(E.Z,{data:(null==k?void 0:k.page)||{},header:t.createElement(v.Z,{datas:(null==k||null===(w=k.page)||void 0===w||null===(T=w.widgets)||void 0===T?void 0:T.filter((e=>"header"===e.position)))||[],render:K,configureValue:null==k||null===(D=k.page)||void 0===D||null===(y=D.configuration)||void 0===y?void 0:y.configureValue,row:1,column:null==k||null===(_=k.page)||void 0===_||null===(V=_.configuration)||void 0===V||null===(M=V.configureValue)||void 0===M?void 0:M.horizontalNumber,onDrop:(e,n)=>U(e,n,"header"),onDragStop:$,onResizeStop:j,onClose:B}),body:t.createElement(v.Z,{datas:(null==k||null===(h=k.page)||void 0===h||null===(G=h.widgets)||void 0===G?void 0:G.filter((e=>"body"===e.position)))||[],render:K,configureValue:null==k||null===(C=k.page)||void 0===C||null===(L=C.configuration)||void 0===L?void 0:L.configureValue,row:null==k||null===(b=k.page)||void 0===b||null===(S=b.configuration)||void 0===S||null===(F=S.configureValue)||void 0===F?void 0:F.verticalNumber,column:null==k||null===(O=k.page)||void 0===O||null===(Y=O.configuration)||void 0===Y||null===(W=Y.configureValue)||void 0===W?void 0:W.horizontalNumber,onDrop:(e,n)=>U(e,n,"body"),onDragStop:$,onResizeStop:j,onClose:B})}))),t.createElement(a.yO,{navs:x,onChange:X,render:e=>{return"layer"===e?t.createElement("div",null,t.createElement(a.TC,{datas:null!=k&&k.page?[null==k?void 0:k.page]:[],pageId:null==k?void 0:k.pageId,widgetId:null==k?void 0:k.widgetId,elementId:null==k?void 0:k.elementId,onSelected:z})):"widget"===e?t.createElement(a.hp,{configureValue:(null==Z||null===(n=Z.configuration)||void 0===n?void 0:n.configureValue)||{},onFinish:e=>{var n;P({type:"MODIFY_WIDGET",data:{...Z,configuration:{...null==Z?void 0:Z.configuration,configureValue:{...null==Z||null===(n=Z.configuration)||void 0===n?void 0:n.configureValue,...e}}}})}}):"element"===e?t.createElement(a.Kp,{element:null==H?void 0:H.element,configureValue:(null==H?void 0:H.configuration.configureValue)||{},onFinish:e=>{var n;P({type:"MODIFY_ELEMENT",data:{...H,configuration:{...null==H?void 0:H.configuration,configureValue:{...null==H||null===(n=H.configuration)||void 0===n?void 0:n.configureValue,...e}}}})}}):"data"===e?t.createElement(a.$X,{widgetDataValue:null==Z||null===(l=Z.configuration)||void 0===l?void 0:l.dataValue,widgetOnFinish:e=>{var n;P({type:"MODIFY_WIDGET",data:{...Z,configuration:{...null==Z?void 0:Z.configuration,dataValue:{...null==Z||null===(n=Z.configuration)||void 0===n?void 0:n.dataValue,...e}}}})},elementDataValue:null==H?void 0:H.configuration.dataValue,elementOnFinish:e=>{var n;P({type:"MODIFY_ELEMENT",data:{...H,configuration:{...null==H?void 0:H.configuration,dataValue:{...null==H||null===(n=H.configuration)||void 0===n?void 0:n.dataValue,...e}}}})}}):"page"===e?t.createElement(a.JB,{configureValue:null==k||null===(i=k.page)||void 0===i||null===(d=i.configuration)||void 0===d?void 0:d.configureValue,onFinish:e=>{var n;const l=null==k||null===(n=k.page)||void 0===n?void 0:n.configuration;P({type:"MODIFY_PAGE",data:{configuration:{...l,configureValue:{...null==l?void 0:l.configureValue,...e}}}})}}):t.createElement("div",null,e);var n,l,i,d}})))}},50780:function(e,n,l){l.r(n),l.d(n,{initialState:function(){return i},pageReducer:function(){return a}});var t=l(86739);const i={page:{name:"未命名页面",id:"",createTime:"",count:0,configuration:{},widgets:[],pageId:"",screenRatio:""},elementId:void 0,widgetId:void 0,pageId:void 0,selectedType:""},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,n=arguments.length>1?arguments[1]:void 0;const l=JSON.parse(JSON.stringify(e));switch(n.type){case t.PAGE:return l.page=n.data,l.pageId=n.data.pageId,l;case t.MODIFY_PAGE:return l.page={...e.page,...n.data},l;case t.SELECT_WIDGET:return l.widgetId=n.widgetId,l.elementId="",l;case t.ADD_WIDGET:return l.page.widgets=[...l.page.widgets,n.data],l.widgetId=n.data.widgetId,l.elementId="",l;case t.MODIFY_WIDGET:{const e=l.page.widgets.findIndex((e=>e.widgetId===n.data.widgetId));return-1!==e&&(l.page.widgets[e]={...l.page.widgets[e],...n.data}),l}case t.DELETE_WIDGET:return l.page.widgets=l.page.widgets.filter((e=>e.widgetId!==n.id)),n.id===l.widgetId&&(l.widgetId=""),l;case t.SELECT_ELEMENT:return l.widgetId=n.widgetId,l.elementId=n.elementId,l;case t.MODIFY_ELEMENT:{const e=l.page.widgets.findIndex((e=>e.widgetId===l.widgetId));if(-1!==e){const t=l.page.widgets[e].elements.findIndex((e=>e.elementId===l.elementId));-1!==t&&(l.page.widgets[e].elements[t]=n.data)}return l}case t.SELECTED_TYPE:return l.selectedType=n.data,l}}},86739:function(e,n,l){l.r(n),l.d(n,{ADD_WIDGET:function(){return d},DELETE_WIDGET:function(){return o},MODIFY_ELEMENT:function(){return g},MODIFY_PAGE:function(){return i},MODIFY_WIDGET:function(){return u},PAGE:function(){return t},SELECTED_TYPE:function(){return c},SELECT_ELEMENT:function(){return r},SELECT_WIDGET:function(){return a}});const t="PAGE",i="MODIFY_PAGE",a="SELECT_WIDGET",d="ADD_WIDGET",o="DELETE_WIDGET",u="MODIFY_WIDGET",r="SELECT_ELEMENT",g="MODIFY_ELEMENT",c="SELECTED_TYPE"}}]);
//# sourceMappingURL=8372.8b4af19347.chunk.js.map