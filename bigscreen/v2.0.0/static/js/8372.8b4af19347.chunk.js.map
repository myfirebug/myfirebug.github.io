{"version":3,"file":"static/js/8372.8b4af19347.chunk.js","mappings":"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","sources":["webpack://large-screen-configuration/./src/pages/web/pageList/edit/index.tsx","webpack://large-screen-configuration/./src/pages/web/pageList/edit/store/reducers.ts","webpack://large-screen-configuration/./src/pages/web/pageList/edit/store/type.ts"],"sourcesContent":["import React, {\r\n  FC,\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useReducer,\r\n  useState,\r\n} from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport {\r\n  ConfigLayoutHeader,\r\n  ConfigLayoutMain,\r\n  ConfigLayoutLeftAside,\r\n  ConfigLayoutRightAside,\r\n  ConfigLayoutRightAsideLayer,\r\n  ConfigLayoutLeftAsideWidget,\r\n  ConfigLayoutRightAsideWidget,\r\n  ConfigLayoutRightAsideElement,\r\n  ConfigLayoutRightAsideData,\r\n  ConfigLayoutRightAsidePage,\r\n  ConfigLayoutMask,\r\n} from \"@src/layout/configLayout\";\r\n\r\nimport \"@src/layout/configLayout/index.scss\";\r\nimport { initialState, pageReducer } from \"./store/reducers\";\r\nimport \"animate.css\";\r\nimport html2canvas from \"html2canvas\";\r\nimport { message } from \"antd\";\r\nimport { capitalizeFirstLetter, guid } from \"@src/utils\";\r\nimport { pageConfig } from \"@src/core/config/base\";\r\nimport \"./index.scss\";\r\nimport elements from \"@src/elements\";\r\n\r\nimport GridLayout from \"@src/layout/gridLayout\";\r\nimport { IElement, IWidget } from \"@src/service\";\r\nimport PreviewLayout from \"@src/layout/previewLayout\";\r\nimport {\r\n  WIDGET_BODY_COLUMN,\r\n  WIDGET_BODY_GAP,\r\n  WIDGET_BODY_ROW,\r\n  WIDGET_HEADER_COLUMN,\r\n  WIDGET_HEADER_GAP,\r\n  WIDGET_HEADER_ROW,\r\n} from \"@src/core/enums/access.enums\";\r\nimport { Layout } from \"react-grid-layout\";\r\n\r\ninterface IConfigLayout {}\r\n\r\nconst ConfigLayout: FC<IConfigLayout> = () => {\r\n  let location = useLocation();\r\n  const [layout, dispatch] = useReducer(pageReducer, initialState);\r\n  const [, setShow] = useState(false);\r\n  const [, setIsShowAuxiliaryLine] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const queryParams = new URLSearchParams(location.search);\r\n    // 编辑\r\n    if (queryParams.size) {\r\n    } else {\r\n      dispatch({\r\n        type: \"PAGE\",\r\n        data: {\r\n          name: \"未命名页面\",\r\n          id: \"\",\r\n          createTime: \"\",\r\n          count: 0,\r\n          pageId: guid(),\r\n          screenRatio: \"4*4\",\r\n          widgets: [],\r\n          configuration: {\r\n            configureValue: { ...pageConfig.configureValue },\r\n          },\r\n        },\r\n      });\r\n    }\r\n  }, [location]);\r\n\r\n  // 判断右侧边栏所需模块\r\n  const rightAside = useMemo(() => {\r\n    let arr: PageType[] = [];\r\n    if (layout?.pageId) {\r\n      arr = [\"layer\", \"page\"];\r\n      if (layout?.widgetId) {\r\n        if (layout?.elementId) {\r\n          arr = [\"layer\", \"element\", \"widget\", \"page\", \"data\"];\r\n        } else {\r\n          arr = [\"layer\", \"widget\", \"page\", \"data\"];\r\n        }\r\n      } else {\r\n        arr = [\"layer\", \"page\"];\r\n      }\r\n    } else {\r\n      arr = [\"layer\"];\r\n    }\r\n    return arr;\r\n  }, [layout?.elementId, layout?.pageId, layout?.widgetId]);\r\n\r\n  // 图层选择\r\n  const layerSelectedHandle = useCallback(\r\n    (type: \"page\" | \"widget\" | \"element\", id: string, pid?: string) => {\r\n      switch (type) {\r\n        case \"widget\": {\r\n          if (layout?.widgetId !== id) {\r\n            dispatch({\r\n              type: \"SELECT_WIDGET\",\r\n              widgetId: id,\r\n            });\r\n          }\r\n          return;\r\n        }\r\n        case \"element\": {\r\n          if (layout?.elementId !== id) {\r\n            dispatch({\r\n              type: \"SELECT_ELEMENT\",\r\n              widgetId: pid as string,\r\n              elementId: id,\r\n            });\r\n          }\r\n          return;\r\n        }\r\n        default:\r\n      }\r\n    },\r\n    [layout?.elementId, layout?.widgetId]\r\n  );\r\n  // 当前选中的微件\r\n  const currentWidget = useMemo(() => {\r\n    return layout?.page?.widgets.find(\r\n      (item) => layout?.widgetId && item.widgetId === layout?.widgetId\r\n    );\r\n  }, [layout?.page?.widgets, layout?.widgetId]);\r\n\r\n  // 当前选中的组件\r\n  const currentElement = useMemo(() => {\r\n    return currentWidget?.elements.find(\r\n      (item) => layout?.elementId && item.elementId === layout?.elementId\r\n    );\r\n  }, [currentWidget?.elements, layout?.elementId]);\r\n\r\n  // 渲染组件\r\n  const renderElement = useCallback(\r\n    (data: IAnyObject) => {\r\n      if (data.element && elements[capitalizeFirstLetter(data.element)]) {\r\n        return (\r\n          <>\r\n            {layout?.elementId === data.elementId &&\r\n            layout?.selectedType === \"element\" ? (\r\n              <ConfigLayoutMask />\r\n            ) : null}\r\n            {React.createElement(\r\n              elements[capitalizeFirstLetter(data.element)],\r\n              {\r\n                options: data.configuration.configureValue,\r\n                data: data.configuration?.dataValue?.mock,\r\n                field: data.configuration?.dataValue?.field,\r\n              }\r\n            )}\r\n          </>\r\n        );\r\n      }\r\n      return <div>你访问的组件不存在请联系售后人员</div>;\r\n    },\r\n    [layout?.elementId, layout?.selectedType]\r\n  );\r\n  // 渲染微件\r\n  const renderWidget = useCallback(\r\n    (data: IAnyObject) => {\r\n      return (\r\n        <>\r\n          {layout?.widgetId === data.widgetId &&\r\n          layout?.selectedType &&\r\n          [\"widget\", \"data\"].includes(layout?.selectedType) ? (\r\n            <ConfigLayoutMask />\r\n          ) : null}\r\n          <PreviewLayout\r\n            data={data}\r\n            header={\r\n              <GridLayout\r\n                datas={\r\n                  data?.elements.filter(\r\n                    (item: IElement) => item.position === \"header\"\r\n                  ) || []\r\n                }\r\n                column={WIDGET_HEADER_COLUMN}\r\n                row={WIDGET_HEADER_ROW}\r\n                gap={WIDGET_HEADER_GAP}\r\n                render={renderElement}\r\n                isDroppable\r\n                isResizable\r\n                staticed\r\n              />\r\n            }\r\n            body={\r\n              <GridLayout\r\n                datas={\r\n                  data?.elements.filter(\r\n                    (item: IElement) => item.position === \"body\"\r\n                  ) || []\r\n                }\r\n                column={WIDGET_BODY_COLUMN}\r\n                row={WIDGET_BODY_ROW}\r\n                gap={WIDGET_BODY_GAP}\r\n                render={renderElement}\r\n                isDroppable\r\n                isResizable\r\n                staticed\r\n              />\r\n            }\r\n          />\r\n        </>\r\n      );\r\n    },\r\n    [layout?.selectedType, layout?.widgetId, renderElement]\r\n  );\r\n  // 新增微件\r\n  const onDrop = useCallback(\r\n    (item: Layout, data: IWidget, type: \"header\" | \"body\") => {\r\n      dispatch({\r\n        type: \"ADD_WIDGET\",\r\n        data: {\r\n          ...data,\r\n          widgetId: guid(),\r\n          x: item.x,\r\n          y: item.y,\r\n          position: type,\r\n          elements: data?.elements?.map((element) => ({\r\n            ...element,\r\n            elementId: guid(),\r\n          })),\r\n        },\r\n      });\r\n    },\r\n    []\r\n  );\r\n  // 修改微件\r\n  const onDragStop = useCallback((item: Layout) => {\r\n    dispatch({\r\n      type: \"MODIFY_WIDGET\",\r\n      data: {\r\n        x: item.x,\r\n        y: item.y,\r\n        widgetId: item.i,\r\n      },\r\n    });\r\n  }, []);\r\n  // 改变大小\r\n  const onResizeStop = useCallback((item: Layout) => {\r\n    dispatch({\r\n      type: \"MODIFY_WIDGET\",\r\n      data: {\r\n        row: item.w,\r\n        column: item.h,\r\n        widgetId: item.i,\r\n      },\r\n    });\r\n  }, []);\r\n\r\n  // 删除微件\r\n  const onClose = useCallback((item: IAnyObject) => {\r\n    dispatch({\r\n      type: \"DELETE_WIDGET\",\r\n      id: item.widgetId,\r\n    });\r\n  }, []);\r\n\r\n  // 改变\r\n  const onChange = useCallback((data: PageType | \"\") => {\r\n    dispatch({\r\n      type: \"SELECTED_TYPE\",\r\n      data,\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"cms-config-layout\">\r\n      <ConfigLayoutHeader\r\n        name={layout?.page?.name}\r\n        pageType=\"page\"\r\n        modifyNameSuccessHander={(name) => {\r\n          dispatch({\r\n            type: \"MODIFY_PAGE\",\r\n            data: {\r\n              name,\r\n            },\r\n          });\r\n        }}\r\n        previewHandler={() => setShow(true)}\r\n        publishHandler={() => {\r\n          setIsShowAuxiliaryLine(false);\r\n          setTimeout(() => {\r\n            html2canvas(document.getElementById(\"js_page\") as HTMLElement, {\r\n              allowTaint: true,\r\n              scale: 0.5,\r\n              backgroundColor: \"rgb(9, 5, 72)\",\r\n            }).then((canvas) => {\r\n              console.log(canvas.toDataURL());\r\n              try {\r\n              } catch (e) {\r\n                message.error(\"存在跨域资源，缩略图获取失败\");\r\n              }\r\n            });\r\n          }, 10);\r\n        }}\r\n      />\r\n      <div className=\"cms-config-layout__content\">\r\n        <ConfigLayoutLeftAside\r\n          navs={[\"widget\"]}\r\n          render={(data) => {\r\n            if (data === \"widget\") {\r\n              return <ConfigLayoutLeftAsideWidget />;\r\n            }\r\n            return null;\r\n          }}\r\n        />\r\n        <ConfigLayoutMain>\r\n          <div\r\n            style={{\r\n              position: \"relative\",\r\n              width: `${layout?.page?.configuration?.configureValue?.pageConfigWidth}px`,\r\n              height: `${layout?.page?.configuration?.configureValue?.pageConfigHeight}px`,\r\n            }}\r\n            id=\"js_page\"\r\n          >\r\n            <PreviewLayout\r\n              data={layout?.page || {}}\r\n              header={\r\n                <GridLayout\r\n                  datas={\r\n                    layout?.page?.widgets?.filter(\r\n                      (item) => item.position === \"header\"\r\n                    ) || []\r\n                  }\r\n                  render={renderWidget}\r\n                  configureValue={layout?.page?.configuration?.configureValue}\r\n                  row={1}\r\n                  column={\r\n                    layout?.page?.configuration?.configureValue\r\n                      ?.horizontalNumber\r\n                  }\r\n                  onDrop={(item, data) => onDrop(item, data, \"header\")}\r\n                  onDragStop={onDragStop}\r\n                  onResizeStop={onResizeStop}\r\n                  onClose={onClose}\r\n                />\r\n              }\r\n              body={\r\n                <GridLayout\r\n                  datas={\r\n                    layout?.page?.widgets?.filter(\r\n                      (item) => item.position === \"body\"\r\n                    ) || []\r\n                  }\r\n                  render={renderWidget}\r\n                  configureValue={layout?.page?.configuration?.configureValue}\r\n                  row={\r\n                    layout?.page?.configuration?.configureValue?.verticalNumber\r\n                  }\r\n                  column={\r\n                    layout?.page?.configuration?.configureValue\r\n                      ?.horizontalNumber\r\n                  }\r\n                  onDrop={(item, data) => onDrop(item, data, \"body\")}\r\n                  onDragStop={onDragStop}\r\n                  onResizeStop={onResizeStop}\r\n                  onClose={onClose}\r\n                />\r\n              }\r\n            />\r\n          </div>\r\n        </ConfigLayoutMain>\r\n        <ConfigLayoutRightAside\r\n          navs={rightAside}\r\n          onChange={onChange}\r\n          render={(data) => {\r\n            if (data === \"layer\") {\r\n              return (\r\n                <div>\r\n                  <ConfigLayoutRightAsideLayer\r\n                    datas={layout?.page ? [layout?.page] : []}\r\n                    pageId={layout?.pageId}\r\n                    widgetId={layout?.widgetId}\r\n                    elementId={layout?.elementId}\r\n                    onSelected={layerSelectedHandle}\r\n                  />\r\n                </div>\r\n              );\r\n            } else if (data === \"widget\") {\r\n              return (\r\n                <ConfigLayoutRightAsideWidget\r\n                  configureValue={\r\n                    (currentWidget?.configuration\r\n                      ?.configureValue as IAnyObject) || {}\r\n                  }\r\n                  onFinish={(data: IAnyObject) => {\r\n                    dispatch({\r\n                      type: \"MODIFY_WIDGET\",\r\n                      data: {\r\n                        ...(currentWidget as IWidget),\r\n                        configuration: {\r\n                          ...currentWidget?.configuration,\r\n                          configureValue: {\r\n                            ...currentWidget?.configuration?.configureValue,\r\n                            ...data,\r\n                          },\r\n                        },\r\n                      },\r\n                    });\r\n                  }}\r\n                />\r\n              );\r\n            } else if (data === \"element\") {\r\n              return (\r\n                <ConfigLayoutRightAsideElement\r\n                  element={currentElement?.element}\r\n                  configureValue={\r\n                    currentElement?.configuration.configureValue || {}\r\n                  }\r\n                  onFinish={(data: IAnyObject) => {\r\n                    dispatch({\r\n                      type: \"MODIFY_ELEMENT\",\r\n                      data: {\r\n                        ...(currentElement as IElement),\r\n                        configuration: {\r\n                          ...currentElement?.configuration,\r\n                          configureValue: {\r\n                            ...currentElement?.configuration?.configureValue,\r\n                            ...data,\r\n                          },\r\n                        },\r\n                      },\r\n                    });\r\n                  }}\r\n                />\r\n              );\r\n            } else if (data === \"data\") {\r\n              return (\r\n                <ConfigLayoutRightAsideData\r\n                  widgetDataValue={currentWidget?.configuration?.dataValue}\r\n                  widgetOnFinish={(data: IAnyObject) => {\r\n                    dispatch({\r\n                      type: \"MODIFY_WIDGET\",\r\n                      data: {\r\n                        ...(currentWidget as IWidget),\r\n                        configuration: {\r\n                          ...currentWidget?.configuration,\r\n                          dataValue: {\r\n                            ...currentWidget?.configuration?.dataValue,\r\n                            ...data,\r\n                          },\r\n                        },\r\n                      },\r\n                    });\r\n                  }}\r\n                  elementDataValue={currentElement?.configuration.dataValue}\r\n                  elementOnFinish={(data: IAnyObject) => {\r\n                    dispatch({\r\n                      type: \"MODIFY_ELEMENT\",\r\n                      data: {\r\n                        ...(currentElement as IElement),\r\n                        configuration: {\r\n                          ...currentElement?.configuration,\r\n                          dataValue: {\r\n                            ...currentElement?.configuration?.dataValue,\r\n                            ...data,\r\n                          },\r\n                        },\r\n                      },\r\n                    });\r\n                  }}\r\n                />\r\n              );\r\n            } else if (data === \"page\") {\r\n              return (\r\n                <ConfigLayoutRightAsidePage\r\n                  configureValue={layout?.page?.configuration?.configureValue}\r\n                  onFinish={(data) => {\r\n                    const configuration = layout?.page?.configuration;\r\n                    dispatch({\r\n                      type: \"MODIFY_PAGE\",\r\n                      data: {\r\n                        configuration: {\r\n                          ...configuration,\r\n                          configureValue: {\r\n                            ...configuration?.configureValue,\r\n                            ...data,\r\n                          },\r\n                        },\r\n                      },\r\n                    });\r\n                  }}\r\n                />\r\n              );\r\n            }\r\n            return <div>{data}</div>;\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ConfigLayout;\r\n","import { ModifyActions } from \"./action\";\r\nimport {\r\n  ALL_STATE,\r\n  PAGE,\r\n  MODIFY_PAGE,\r\n  SELECT_WIDGET,\r\n  SELECT_ELEMENT,\r\n  ADD_WIDGET,\r\n  MODIFY_WIDGET,\r\n  MODIFY_ELEMENT,\r\n  DELETE_WIDGET,\r\n  SELECTED_TYPE,\r\n} from \"./type\";\r\n\r\nexport const initialState: ALL_STATE = {\r\n  page: {\r\n    name: \"未命名页面\",\r\n    id: \"\",\r\n    createTime: \"\",\r\n    count: 0,\r\n    configuration: {},\r\n    widgets: [],\r\n    pageId: \"\",\r\n    screenRatio: \"\",\r\n  },\r\n  elementId: undefined,\r\n  widgetId: undefined,\r\n  pageId: undefined,\r\n  selectedType: \"\",\r\n};\r\n\r\nexport const pageReducer = (state = initialState, action: ModifyActions) => {\r\n  const copy: ALL_STATE = JSON.parse(JSON.stringify(state));\r\n  console.log(state, action);\r\n  switch (action.type) {\r\n    // 获取页面\r\n    case PAGE: {\r\n      copy.page = action.data;\r\n      copy.pageId = action.data.pageId;\r\n      return copy;\r\n    }\r\n    case MODIFY_PAGE: {\r\n      copy.page = {\r\n        ...state.page,\r\n        ...action.data,\r\n      };\r\n      return copy;\r\n    }\r\n    case SELECT_WIDGET: {\r\n      copy.widgetId = action.widgetId;\r\n      copy.elementId = \"\";\r\n      return copy;\r\n    }\r\n    case ADD_WIDGET: {\r\n      copy.page.widgets = [...copy.page.widgets, action.data];\r\n      copy.widgetId = action.data.widgetId;\r\n      copy.elementId = \"\";\r\n      return copy;\r\n    }\r\n    case MODIFY_WIDGET: {\r\n      const index = copy.page.widgets.findIndex(\r\n        (item) => item.widgetId === action.data.widgetId\r\n      );\r\n      if (index !== -1) {\r\n        copy.page.widgets[index] = {\r\n          ...copy.page.widgets[index],\r\n          ...action.data,\r\n        };\r\n      }\r\n      return copy;\r\n    }\r\n    case DELETE_WIDGET: {\r\n      copy.page.widgets = copy.page.widgets.filter(\r\n        (item) => item.widgetId !== action.id\r\n      );\r\n      if (action.id === copy.widgetId) {\r\n        copy.widgetId = \"\";\r\n      }\r\n      return copy;\r\n    }\r\n    case SELECT_ELEMENT: {\r\n      copy.widgetId = action.widgetId;\r\n      copy.elementId = action.elementId;\r\n      return copy;\r\n    }\r\n    case MODIFY_ELEMENT: {\r\n      const currentWidgetIndex = copy.page.widgets.findIndex(\r\n        (item) => item.widgetId === copy.widgetId\r\n      );\r\n      if (currentWidgetIndex !== -1) {\r\n        const currentElementIndex = copy.page.widgets[\r\n          currentWidgetIndex\r\n        ].elements.findIndex((item) => item.elementId === copy.elementId);\r\n        if (currentElementIndex !== -1) {\r\n          copy.page.widgets[currentWidgetIndex].elements[currentElementIndex] =\r\n            action.data;\r\n        }\r\n      }\r\n      return copy;\r\n    }\r\n    case SELECTED_TYPE: {\r\n      copy.selectedType = action.data;\r\n      return copy;\r\n    }\r\n    default: {\r\n      console.log(\"你访问的类型不对，请自行检查\");\r\n    }\r\n  }\r\n};\r\n","import { IPage } from \"@src/service\";\r\n\r\n// 获取页面\r\nexport const PAGE = \"PAGE\";\r\nexport type PAGE_TYPE = typeof PAGE;\r\n\r\n// 修改页面\r\nexport const MODIFY_PAGE = \"MODIFY_PAGE\";\r\nexport type MODIFY_PAGE_TYPE = typeof MODIFY_PAGE;\r\n\r\n// 选中微件\r\nexport const SELECT_WIDGET = \"SELECT_WIDGET\";\r\nexport type SELECT_WIDGET_TYPE = typeof SELECT_WIDGET;\r\n\r\n// 添加微件\r\nexport const ADD_WIDGET = \"ADD_WIDGET\";\r\nexport type ADD_WIDGET_TYPE = typeof ADD_WIDGET;\r\n\r\n// 删除微件\r\nexport const DELETE_WIDGET = \"DELETE_WIDGET\";\r\nexport type DELETE_WIDGET_TYPE = typeof DELETE_WIDGET;\r\n\r\n// 修改微件\r\nexport const MODIFY_WIDGET = \"MODIFY_WIDGET\";\r\nexport type MODIFY_WIDGET_TYPE = typeof MODIFY_WIDGET;\r\n\r\n// 选中组件\r\nexport const SELECT_ELEMENT = \"SELECT_ELEMENT\";\r\nexport type SELECT_ELEMENT_TYPE = typeof SELECT_ELEMENT;\r\n\r\n// 修改微件\r\nexport const MODIFY_ELEMENT = \"MODIFY_ELEMENT\";\r\nexport type MODIFY_ELEMENT_TYPE = typeof MODIFY_ELEMENT;\r\n\r\n// 修改选中类型\r\nexport const SELECTED_TYPE = \"SELECTED_TYPE\";\r\nexport type SELECTED_TYPE_TYPE = typeof SELECTED_TYPE;\r\n\r\nexport interface ALL_STATE {\r\n  page: IPage;\r\n  elementId: string | undefined;\r\n  widgetId: string | undefined;\r\n  pageId: string | undefined;\r\n  selectedType: PageType | \"\";\r\n}\r\n"],"names":["ConfigLayout","_layout$page2","_layout$page3","_layout$page4","_layout$page4$configu","_layout$page4$configu2","_layout$page5","_layout$page5$configu","_layout$page5$configu2","_layout$page6","_layout$page6$widgets","_layout$page7","_layout$page7$configu","_layout$page8","_layout$page8$configu","_layout$page8$configu2","_layout$page9","_layout$page9$widgets","_layout$page10","_layout$page10$config","_layout$page11","_layout$page11$config","_layout$page11$config2","_layout$page12","_layout$page12$config","_layout$page12$config2","location","useLocation","layout","dispatch","useReducer","pageReducer","initialState","setShow","useState","setIsShowAuxiliaryLine","useEffect","URLSearchParams","search","size","type","data","name","id","createTime","count","pageId","guid","screenRatio","widgets","configuration","configureValue","pageConfig","rightAside","useMemo","arr","widgetId","elementId","layerSelectedHandle","useCallback","pid","currentWidget","_layout$page","page","find","item","currentElement","elements","renderElement","_data$configuration","_data$configuration$d","_data$configuration2","_data$configuration2$","element","capitalizeFirstLetter","React","selectedType","ConfigLayoutMask","options","dataValue","mock","field","renderWidget","includes","PreviewLayout","header","GridLayout","datas","filter","position","column","WIDGET_HEADER_COLUMN","row","WIDGET_HEADER_ROW","gap","WIDGET_HEADER_GAP","render","isDroppable","isResizable","staticed","body","WIDGET_BODY_COLUMN","WIDGET_BODY_ROW","WIDGET_BODY_GAP","onDrop","_data$elements","x","y","map","onDragStop","i","onResizeStop","w","h","onClose","onChange","className","ConfigLayoutHeader","pageType","modifyNameSuccessHander","previewHandler","publishHandler","setTimeout","html2canvas","document","getElementById","allowTaint","scale","backgroundColor","then","canvas","ConfigLayoutLeftAside","navs","ConfigLayoutLeftAsideWidget","ConfigLayoutMain","style","width","pageConfigWidth","height","pageConfigHeight","horizontalNumber","verticalNumber","ConfigLayoutRightAside","ConfigLayoutRightAsideLayer","onSelected","ConfigLayoutRightAsideWidget","_currentWidget$config","onFinish","_currentWidget$config2","ConfigLayoutRightAsideElement","_currentElement$confi","ConfigLayoutRightAsideData","widgetDataValue","_currentWidget$config3","widgetOnFinish","_currentWidget$config4","elementDataValue","elementOnFinish","_currentElement$confi2","ConfigLayoutRightAsidePage","_layout$page13","_layout$page13$config","_layout$page14","undefined","state","arguments","length","action","copy","JSON","parse","stringify","PAGE","MODIFY_PAGE","SELECT_WIDGET","ADD_WIDGET","MODIFY_WIDGET","index","findIndex","DELETE_WIDGET","SELECT_ELEMENT","MODIFY_ELEMENT","currentWidgetIndex","currentElementIndex","SELECTED_TYPE"],"sourceRoot":""}