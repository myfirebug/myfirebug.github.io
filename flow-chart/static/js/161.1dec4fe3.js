"use strict";(self.webpackChunkflow_chart=self.webpackChunkflow_chart||[]).push([[161,635],{39233:function(e,t,r){r.d(t,{JX:function(){return u},K$:function(){return i},Qf:function(){return s},aZ:function(){return a},cu:function(){return o},d:function(){return n},eE:function(){return c},tr:function(){return d}});var n=8,d=6,s=40,a=14,c=10,u=10,i=16,o=24},25161:function(e,t,r){r.r(t),r.d(t,{diagrams:function(){return l},initialState:function(){return i}});var n=r(1413),d=r(93433),s=r(39233),a=r(6635),c=r(10133),u=function(e){var t=s.Qf;return e.ports.some((function(e){return e.visible}))&&(t+=s.cu+s.eE),e.inParams.forEach((function(){t+=s.cu})),t+=s.eE},i={id:null,title:"",description:"",createTime:"",selectedCardsIds:"",x:0,y:0,cards:[],edges:[],undo:[],redo:[]};function o(e){var t=(0,d.Z)(e.undo),r=(0,d.Z)(e.redo);if(t.length>=50){var n=t.shift();t.push({x:e.x,y:e.y,title:e.title,cards:e.cards,edges:e.edges,selectedCardsIds:e.selectedCardsIds}),0!==r.length&&n&&(r.pop(),r.unshift(n))}else t.push({x:e.x,y:e.y,title:e.title,cards:e.cards,edges:e.edges,selectedCardsIds:e.selectedCardsIds});return{undo:t,redo:r}}var l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0,r=JSON.parse(JSON.stringify(e));switch(t.type){case a.DIAGRAMS:return(0,n.Z)((0,n.Z)({},t.data),{},{cards:t.data.cards.map((function(e){return(0,n.Z)((0,n.Z)({},e),{},{height:u(e)})}))});case a.MODIFY_DIAGRAMS_TITLE:return(0,n.Z)((0,n.Z)({},r),{},{title:t.title},o(r));case a.ADD_CARD:return(0,n.Z)((0,n.Z)({},r),{},{cards:[].concat((0,d.Z)(r.cards),[(0,n.Z)((0,n.Z)({},t.data),{},{x:t.data.x-r.x,y:t.data.y-r.y,ports:t.data.ports.map((function(e){return(0,n.Z)((0,n.Z)({},e),{},{id:(0,c.M8)()})})),height:u(t.data)})]),selectedCardsIds:t.data.id},o(r));case a.MODIFY_CARD:return(0,n.Z)((0,n.Z)({},r),{},{cards:r.cards.map((function(e){return r.selectedCardsIds.includes(e.id)?(0,n.Z)((0,n.Z)({},e),t.data):e}))},o(r));case a.SELECTS_CARD:return(0,n.Z)((0,n.Z)({},r),{},{selectedCardsIds:t.ids});case a.MODIFY_DIAGRAMS_COORDINATE:return(0,n.Z)((0,n.Z)((0,n.Z)({},r),t.coordinate),o(r));case a.MODIFY_CARDS_COORDINATE:return(0,n.Z)((0,n.Z)({},r),{},{cards:r.cards.map((function(e){return r.selectedCardsIds&&r.selectedCardsIds.includes(e.id)?(0,n.Z)((0,n.Z)({},e),{},{x:e.x+t.coordinate.x,y:e.y+t.coordinate.y}):e}))},o(r));case a.ADD_EDGE:return(0,n.Z)((0,n.Z)({},r),{},{edges:[].concat((0,d.Z)(r.edges),[t.edge])},o(r));case a.DEL_CARD:return(0,n.Z)((0,n.Z)({},r),{},{cards:r.cards.filter((function(e){return!r.selectedCardsIds.includes(e.id)})),edges:r.edges.filter((function(e){return!r.selectedCardsIds.includes(e.data.source)&&!r.selectedCardsIds.includes(e.data.target)})),selectedCardsIds:""},o(r));case a.COPY_CARD:var s=[],l=r.cards.filter((function(e){return r.selectedCardsIds.includes(e.id)})).map((function(e){var t=(0,c.M8)();return s.push(t),(0,n.Z)((0,n.Z)({},e),{},{title:"".concat(e.title,"[\u590d\u5236]"),id:t,ports:e.ports.map((function(e){return(0,n.Z)((0,n.Z)({},e),{},{id:(0,c.M8)()})}))})}));return(0,n.Z)((0,n.Z)({},r),{},{cards:[].concat((0,d.Z)(r.cards),(0,d.Z)(l)),selectedCardsIds:s.join(",")},o(r));case a.SELECT_ALL:var f=[];return r.cards.forEach((function(e){f.push(e.id)})),(0,n.Z)((0,n.Z)({},r),{},{selectedCardsIds:f.join(",")},o(r));case a.CARDS_ALIGN:for(var D=r.cards.filter((function(e){return r.selectedCardsIds.includes(e.id)})),C=D[0].x,Z=D[0].y,A=D[0].y+D[0].height,I=D[0].x+D[0].width,_=1;_<D.length;_++)C>=D[_].x&&(C=D[_].x),Z>=D[_].y&&(Z=D[_].y),A<=D[_].y+D[_].height&&(A=D[_].y+D[_].height),I<=D[_].x+D[_].width&&(I=D[_].x+D[_].width);return r.cards=r.cards.map((function(e){return r.selectedCardsIds.includes(e.id)?(0,n.Z)((0,n.Z)({},e),{},{x:"left"===t.align?C:"right"===t.align?I-e.width:e.x,y:"top"===t.align?Z:"bottom"===t.align?A-e.height:e.y}):e})),(0,n.Z)((0,n.Z)({},r),o(r));case a.UNDO:if(r.undo.length){var h=r.undo.pop();h&&(r=(0,n.Z)((0,n.Z)({},r),{},{redo:[].concat((0,d.Z)(r.redo),[{x:r.x,y:r.y,title:r.title,cards:r.cards,edges:r.edges,selectedCardsIds:r.selectedCardsIds}])},h))}return(0,n.Z)({},r);case a.REDO:if(r.redo.length){var E=r.redo.pop();E&&(r=(0,n.Z)((0,n.Z)({},r),{},{undo:[].concat((0,d.Z)(r.undo),[{x:r.x,y:r.y,title:r.title,cards:r.cards,edges:r.edges,selectedCardsIds:r.selectedCardsIds}])},E))}return(0,n.Z)({},r);default:return e}}},6635:function(e,t,r){r.r(t),r.d(t,{ADD_CARD:function(){return a},ADD_EDGE:function(){return o},CARDS_ALIGN:function(){return C},COPY_CARD:function(){return f},DEL_CARD:function(){return l},DIAGRAMS:function(){return n},MODIFY_CARD:function(){return c},MODIFY_CARDS_COORDINATE:function(){return u},MODIFY_DIAGRAMS_COORDINATE:function(){return s},MODIFY_DIAGRAMS_TITLE:function(){return d},REDO:function(){return A},SELECTS_CARD:function(){return i},SELECT_ALL:function(){return D},UNDO:function(){return Z}});var n="DIAGRAMS",d="MODIFY_DIAGRAMS_TITLE",s="MODIFY_DIAGRAMS_COORDINATE",a="ADD_CARD",c="MODIFY_CARD",u="MODIFY_CARDS_COORDINATE",i="SELECTS_CARD",o="ADD_EDGE",l="DEL_CARD",f="COPY_CARD",D="SELECT_ALL",C="CARDS_ALIGN",Z="UNDO",A="REDO"},59199:function(e,t,r){function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.d(t,{Z:function(){return n}})},93433:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(30907);var d=r(59199),s=r(40181);function a(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||(0,d.Z)(e)||(0,s.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);