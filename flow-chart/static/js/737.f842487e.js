"use strict";(self.webpackChunkflow_chart=self.webpackChunkflow_chart||[]).push([[737,940,997,469,4,635],{65035:function(e,s,a){a.r(s);var n=a(29439),c=a(72791),t=a(6362),i=a(80542),l=(a(5940),a(1992)),d=a(80184);s.default=function(){var e=(0,c.useContext)(l.DiagramsConfigurationContext),s=(0,c.useState)(!1),a=(0,n.Z)(s,2),r=a[0],u=a[1],o=t.l0.useForm(),x=(0,n.Z)(o,1)[0],m=(0,i.k6)();(0,c.useEffect)((function(){x&&(0,x.setFieldValue)("title",e.data.title)}),[x,e.data.title]);return(0,d.jsxs)("div",{className:"app-diagrams-configuration__header",children:[(0,d.jsxs)("div",{className:"left",children:[(0,d.jsx)(t.u,{placement:"bottom",title:"\u8fd4\u56de",children:(0,d.jsx)("div",{className:"return app-icon",onClick:function(){return m.goBack()},children:"\ue720"})}),(0,d.jsx)("div",{className:"app-icon logo",children:"\ue605"}),(0,d.jsxs)("div",{className:"content",children:[(0,d.jsxs)("div",{className:"top",children:[(0,d.jsx)("span",{className:"title",children:e.data.title}),(0,d.jsx)("span",{className:"app-icon",onClick:function(){return u(!0)},children:"\uec88"})]}),(0,d.jsxs)("ul",{className:"menu",children:[(0,d.jsxs)("li",{className:"menu-item",children:[(0,d.jsx)("div",{className:"name",children:"\u6587\u4ef6"}),(0,d.jsxs)("dl",{className:"sub-menu",children:[(0,d.jsxs)("dd",{onClick:function(){return u(!0)},children:[(0,d.jsx)("span",{className:"app-icon",children:"\uec88"}),(0,d.jsx)("span",{className:"name",children:"\u91cd\u547d\u540d"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue63b"}),(0,d.jsx)("span",{className:"name",children:"\u4fdd\u5b58"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+S"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue765"}),(0,d.jsx)("span",{className:"name",children:"\u514b\u9686"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue8e7"}),(0,d.jsx)("span",{className:"name",children:"\u5173\u95ed"})]})]})]}),(0,d.jsxs)("li",{className:"menu-item",children:[(0,d.jsx)("div",{className:"name",children:"\u7f16\u8f91"}),(0,d.jsxs)("dl",{className:"sub-menu",children:[(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue61e"}),(0,d.jsx)("span",{className:"name",children:"\u64a4\u9500"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+Z"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue60f"}),(0,d.jsx)("span",{className:"name",children:"\u6062\u590d"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+Y"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ueb4b"}),(0,d.jsx)("span",{className:"name",children:"\u526a\u5207"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+X"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue8b0"}),(0,d.jsx)("span",{className:"name",children:"\u62f7\u8d1d"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+C"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue677"}),(0,d.jsx)("span",{className:"name",children:"\u7c98\u8d34"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+V"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue7c3"}),(0,d.jsx)("span",{className:"name",children:"\u5220\u9664"}),(0,d.jsx)("span",{className:"value",children:"Delete"})]})]})]}),(0,d.jsxs)("li",{className:"menu-item",children:[(0,d.jsx)("div",{className:"name",children:"\u9009\u62e9"}),(0,d.jsx)("dl",{className:"sub-menu",children:(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue9c5"}),(0,d.jsx)("span",{className:"name",children:"\u5168\u9009"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+A"})]})})]}),(0,d.jsxs)("li",{className:"menu-item",children:[(0,d.jsx)("div",{className:"name",children:"\u6392\u5217"}),(0,d.jsxs)("dl",{className:"sub-menu",children:[(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue786"}),(0,d.jsx)("span",{className:"name",children:"\u7f6e\u4e8e\u9876\u5c42"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+\u2191"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue742"}),(0,d.jsx)("span",{className:"name",children:"\u7f6e\u4e8e\u5e95\u5c42"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+\u2193"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue7ef"}),(0,d.jsx)("span",{className:"name",children:"\u4e0a\u79fb\u4e00\u5c42"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+Shfit+\u2191"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue7f1"}),(0,d.jsx)("span",{className:"name",children:"\u4e0b\u79fb\u4e00\u5c42"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+Shfit+\u2193"})]})]})]}),(0,d.jsxs)("li",{className:"menu-item",children:[(0,d.jsx)("div",{className:"name",children:"\u5bf9\u9f50"}),(0,d.jsxs)("dl",{className:"sub-menu",children:[(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue602"}),(0,d.jsx)("span",{className:"name",children:"\u5de6\u5bf9\u9f50"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+L"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue65b"}),(0,d.jsx)("span",{className:"name",children:"\u53f3\u5bf9\u9f50"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+R"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue603"}),(0,d.jsx)("span",{className:"name",children:"\u9876\u7aef\u5bf9\u9f50"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+T"})]}),(0,d.jsxs)("dd",{children:[(0,d.jsx)("span",{className:"app-icon",children:"\ue604"}),(0,d.jsx)("span",{className:"name",children:"\u5e95\u7aef\u5bf9\u9f50"}),(0,d.jsx)("span",{className:"value",children:"Ctrl+B"})]})]})]})]})]})]}),(0,d.jsx)("div",{className:"right",children:(0,d.jsx)(t.zx,{type:"primary",children:"\u4fdd\u5b58"})}),(0,d.jsx)(t.u_,{title:"\u4fee\u6539\u6d41\u7a0b\u56fe\u6807\u9898",open:r,onOk:function(){(0,x.validateFields)().then((function(s){e.dispatch({type:"MODIFY_DIAGRAMS_TITLE",title:s.title}),t.yw.success("\u4fee\u6539\u6210\u529f"),u(!1)}))},onCancel:function(){u(!1)},children:(0,d.jsx)(t.l0,{style:{maxWidth:600},autoComplete:"off",form:x,children:(0,d.jsx)(t.l0.Item,{label:"\u6d41\u7a0b\u56fe\u540d\u79f0",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6d41\u7a0b\u56fe\u540d\u79f0"}],children:(0,d.jsx)(t.II,{})})})})]})}},99512:function(e,s,a){a.r(s);var n=a(1413),c=a(29439),t=a(72791),i=a(6362),l=a(10133),d=(a(59997),a(28101)),r=a(1992),u=a(80184),o=i.UO.Panel;s.default=function(){var e=(0,t.useContext)(r.DiagramsConfigurationContext),s=(0,t.useState)([]),a=(0,c.Z)(s,2),x=a[0],m=a[1],h=(0,t.useState)([]),p=(0,c.Z)(h,2),j=p[0],f=p[1];(0,t.useEffect)((function(){d.Z.cardList().then((function(e){var s=e.data;m(s.filter((function(e){return"base"===e.type}))),f(s.filter((function(e){return"other"===e.type})))}))}),[]);var N=function(s){e.dispatch({type:"ADD_CARD",data:(0,n.Z)((0,n.Z)({},s),{},{id:(0,l.M8)(),inParams:s.inParams?s.inParams.map((function(e){return(0,n.Z)((0,n.Z)({},e),{},{id:(0,l.M8)()})})):[],ports:s.ports?s.ports.map((function(e){return(0,n.Z)((0,n.Z)({},e),{},{id:(0,l.M8)()})})):[]})})};return(0,u.jsx)("div",{className:"app-diagrams-configuration__menus",children:(0,u.jsx)("div",{className:"body",children:(0,u.jsxs)(i.UO,{defaultActiveKey:["1"],children:[(0,u.jsx)(o,{header:"\u57fa\u7840\u5361\u7247",children:(0,u.jsx)("ul",{className:"menu-list",children:x.map((function(e){return(0,u.jsx)("li",{className:"menu-item",onClick:function(){return N(e)},children:e.title},e.id)}))})},"1"),(0,u.jsx)(o,{header:"\u5176\u4ed6\u5361\u7247",children:(0,u.jsx)("ul",{className:"menu-list",children:j.map((function(e){return(0,u.jsx)("li",{className:"menu-item",onClick:function(){return N(e)},children:e.title},e.id)}))})},"2")]})})})}},76485:function(e,s,a){a.r(s);var n=a(72791),c=a(6362),t=(a(95469),a(25925)),i=a(1992),l=a(59044),d=a(80184);s.default=function(){var e=(0,n.useContext)(i.DiagramsConfigurationContext),s=(0,n.useMemo)((function(){var s=e.data,a=s.cards,n=s.selectedCardsIds,c=[],t=a.findIndex((function(e){return n&&n.includes(e.id)}));return-1!==t&&(c=a[t].inParams),c}),[e]);return(0,d.jsx)("div",{className:"app-diagrams-configuration__settings",children:(0,d.jsx)("div",{className:"body",children:(0,d.jsxs)(c.mQ,{defaultActiveKey:"1",centered:!0,children:[(0,d.jsx)(c.mQ.TabPane,{tab:"\u56fe\u5c42",children:e.data.cards.length?(0,d.jsx)("ul",{className:"card-list",children:e.data.cards.map((function(s){return(0,d.jsxs)("li",{className:"card-item ".concat(e.data.selectedCardsIds&&e.data.selectedCardsIds.includes(s.id)?"is-active":""),children:[(0,d.jsx)("div",{className:"title",children:s.title}),(0,d.jsxs)("div",{className:"operation",children:[(0,d.jsx)(c.u,{title:"\u590d\u5236",children:(0,d.jsx)(l.CopyOutlined,{})}),(0,d.jsx)(c.u,{title:"\u5220\u9664",children:(0,d.jsx)(l.DeleteOutlined,{})})]})]},s.id)}))}):(0,d.jsx)(c.x4,{status:"404",title:"\u6682\u65e0\u6570\u636e",subTitle:"\u70b9\u51fb\u5361\u7247\uff0c\u6dfb\u52a0\u5361\u7247"})},"1"),(0,d.jsx)(c.mQ.TabPane,{tab:"\u914d\u7f6e",children:s.length?(0,d.jsx)(t.Z,{list:s}):(0,d.jsx)(c.x4,{status:"404",title:"\u6682\u65e0\u6570\u636e",subTitle:"\u9700\u8981\u9009\u4e2d\u5361\u7247\u624d\u6709\u6570\u636e\u54e6"})},"2")]})})})}},1992:function(e,s,a){a.r(s),a.d(s,{DiagramsConfigurationContext:function(){return p},default:function(){return j}});var n=a(1413),c=a(29439),t=a(72791),i=a(89982),l=a(65035),d=a(76485),r=a(99512),u=(a(82004),a(25161)),o=a(10133),x=a(30256),m=a(80184),h=function(e){var s=e.s,a=e.e,n=(0,t.useMemo)((function(){var e=Math.abs(a.y-s.y),n=Math.floor(e/3*2),c={x:s.x,y:s.y+4+n},t={x:a.x,y:a.y-4-n};return"M ".concat(s.x," ").concat(s.y,"\n       L ").concat(s.x," ").concat(s.y+4,"\n       C ").concat(c.x," ").concat(c.y," ").concat(t.x," ").concat(t.y," ").concat(a.x," ").concat(a.y-4,"\n       L ").concat(a.x," ").concat(a.y,"\n      ")}),[s,a]);return(0,m.jsx)(i.Path,{data:n,stroke:"#096dd9",strokeWidth:2})},p=t.createContext({data:u.initialState,dispatch:function(){}}),j=function(){var e=(0,t.useReducer)(u.diagrams,u.initialState),s=(0,c.Z)(e,2),a=s[0],j=s[1],f=(0,t.useState)({x:0,y:0,width:window.innerWidth-600,height:window.innerHeight-62}),N=(0,c.Z)(f,2),C=N[0],v=N[1],y=(0,t.useState)(),D=(0,c.Z)(y,2),g=D[0],I=D[1],A=(0,t.useState)({sx:0,sy:0,ex:0,ey:0,distanceCardX:0,distanceCardY:0,distanceStageX:0,distanceStageY:0}),S=(0,c.Z)(A,2),_=S[0],Z=S[1];(0,t.useEffect)((function(){(0,o.Gr)("id")||j({type:"DIAGRAMS",data:{id:null,title:"\u672a\u547d\u540d\u6d41\u7a0b\u56fe",description:"",selectedCardsIds:"",x:0,y:0,cards:[]}})}),[]);var M=(0,t.useCallback)((function(e){var s=e.evt,n=s.offsetX,c=s.offsetY,t=e.target.attrs,i=t.type,l=t.cx,d=t.cy,r=t.id,u=t.cardId;t.portId;i&&I(i),"stage"===i||a.selectedCardsIds&&a.selectedCardsIds.includes(r)||j({type:"SELECTS_CARD",ids:r||u}),"stage"===i&&a.selectedCardsIds&&j({type:"SELECTS_CARD",ids:""}),Z({sx:n,sy:c,ex:n,ey:c,distanceCardX:n-l,distanceCardY:c-d,distanceStageX:n-C.x,distanceStageY:c-C.y})}),[a.selectedCardsIds,C.x,C.y]),R=(0,t.useCallback)((function(e){var s=e.evt,a=s.offsetX,c=s.offsetY;switch(Z((function(e){return(0,n.Z)((0,n.Z)({},e),{},{ex:a,ey:c})})),g){case"move":j({type:"MODIFY_CARD",data:{x:a-_.distanceCardX,y:c-_.distanceCardY}});break;case"stage":v((function(e){return(0,n.Z)((0,n.Z)({},e),{},{x:a-_.distanceStageX,y:c-_.distanceStageY})}))}}),[g,_.distanceCardX,_.distanceCardY,_.distanceStageX,_.distanceStageY]),O=(0,t.useCallback)((function(e){"stage"===g&&j({type:"MODIFY_DIAGRAMS_COORDINATE",coordinate:{x:C.x,y:C.y}}),I("")}),[C.x,C.y,g]);return(0,m.jsx)(p.Provider,{value:{dispatch:j,data:a},children:(0,m.jsxs)("div",{className:"app-diagrams-configuration",children:[(0,m.jsx)(l.default,{}),(0,m.jsxs)("div",{className:"app-diagrams-configuration__body",children:[(0,m.jsx)(r.default,{}),(0,m.jsx)("div",{className:"app-diagrams-configuration__container",id:"js_stage",children:(0,m.jsxs)(i.Stage,(0,n.Z)((0,n.Z)({},C),{},{type:"stage",onMouseDown:M,onMouseMove:R,onMouseUp:O,children:[(0,m.jsx)(i.Layer,{children:a.cards?a.cards.map((function(e){return(0,m.jsx)(x.Z,{config:e,SelectedCardsIds:a.selectedCardsIds},e.id)})):null}),(0,m.jsx)(i.Layer,{children:"port"===g?(0,m.jsx)(h,{s:{x:_.sx-a.x,y:_.sy-a.y},e:{x:_.ex-a.x,y:_.ey-a.y}}):null})]}))}),(0,m.jsx)(d.default,{})]}),(0,m.jsx)("div",{className:"app-diagrams-configuration__footer"})]})})}},25161:function(e,s,a){a.r(s),a.d(s,{diagrams:function(){return r},initialState:function(){return d}});var n=a(93433),c=a(1413),t=a(39233),i=a(6635),l=function(e){var s=t.Qf;return e.ports.some((function(e){return e.visible}))&&(s+=t.cu+t.eE),e.inParams.forEach((function(){s+=t.cu})),s+=t.eE},d={id:null,title:"",description:"",createTime:"",selectedCardsIds:"",x:0,y:0,cards:[]},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,s=arguments.length>1?arguments[1]:void 0,a=JSON.parse(JSON.stringify(e));switch(s.type){case i.DIAGRAMS:return(0,c.Z)((0,c.Z)({},s.data),{},{cards:s.data.cards.map((function(e){return(0,c.Z)((0,c.Z)({},e),{},{height:l(e)})}))});case i.MODIFY_DIAGRAMS_TITLE:return(0,c.Z)((0,c.Z)({},a),{},{title:s.title});case i.ADD_CARD:return(0,c.Z)((0,c.Z)({},a),{},{cards:[].concat((0,n.Z)(a.cards),[(0,c.Z)((0,c.Z)({},s.data),{},{x:s.data.x-a.x,y:s.data.y-a.y,height:l(s.data)})]),selectedCardsIds:s.data.id});case i.MODIFY_CARD:return(0,c.Z)((0,c.Z)({},a),{},{cards:a.cards.map((function(e){return a.selectedCardsIds.includes(e.id)?(0,c.Z)((0,c.Z)({},e),s.data):e}))});case i.SELECTS_CARD:return(0,c.Z)((0,c.Z)({},a),{},{selectedCardsIds:s.ids});case i.MODIFY_DIAGRAMS_COORDINATE:return(0,c.Z)((0,c.Z)({},a),s.coordinate);default:return e}}},6635:function(e,s,a){a.r(s),a.d(s,{ADD_CARD:function(){return i},DIAGRAMS:function(){return n},MODIFY_CARD:function(){return l},MODIFY_DIAGRAMS_COORDINATE:function(){return t},MODIFY_DIAGRAMS_TITLE:function(){return c},SELECTS_CARD:function(){return d}});var n="DIAGRAMS",c="MODIFY_DIAGRAMS_TITLE",t="MODIFY_DIAGRAMS_COORDINATE",i="ADD_CARD",l="MODIFY_CARD",d="SELECTS_CARD"},5940:function(e,s,a){a.r(s),s.default={}},59997:function(e,s,a){a.r(s),s.default={}},95469:function(e,s,a){a.r(s),s.default={}},82004:function(e,s,a){a.r(s),s.default={}}}]);