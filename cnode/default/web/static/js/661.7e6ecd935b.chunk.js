(self.webpackChunkcli=self.webpackChunkcli||[]).push([[661,71,756,802],{8349:function(e,t,r){"use strict";r.d(t,{B:function(){return p}});var a=r(7294);class s{static getTopic(e){return`/topic/${e}`}static topicCollectByLoginname(e){return`/topic_collect/${e}`}static addReply(e){return`/topic/${e}/replies`}static replyUps(e){return`/reply/${e}/ups`}}s.getTopics="/topics",s.addTopics="/topics",s.updateTopics="/topics/update",s.topicCollect="/topic_collect/collect";var i=r(2861),n=r(129),o=r.n(n);i.Z.defaults.baseURL="https://cnodejs.org/api/v1";const c=[],l=function(e){for(let t=0,r=c.length;t<r;t++)if(c[t]===e){c.splice(t,1);break}};i.Z.interceptors.request.use((e=>{const t=i.Z.CancelToken.source();return"object"==typeof e.headers&&(e.headers.Authorization="Bearer 123"),e.cancelToken=t.token,function(e,t){for(let r=0,a=c.length;r<a;r++)if(c[r]===e)return void t.cancel();c.push(e)}(`${e.url}?${o().stringify(e.params)}&method=${e.method}`,t),e}),(e=>Promise.reject(e))),i.Z.interceptors.response.use((e=>{const{config:t,status:r}=e;if(console.log(t,"config"),t&&l(`${t.url}?${o().stringify(t.params)}&method=${t.method}`),200!==r)throw new Error("请求出现异常, HTTP 状态码不为 200");return e.data.data}),(e=>{const{config:t}=e;return t&&l(`${t.url}?${o().stringify(t.params)}&method=${t.method}`),Promise.reject(e)}));var u=i.Z;const m={topicService:{getTopics(e){return u.get(s.getTopics,{params:e})},getTopic(e){return u.get(s.getTopic(e))}}};var d=r(589);function p(){const[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!0),[i,n]=(0,a.useState)(!1),o=(0,a.useCallback)((async e=>{n(!0);const r=await m.topicService.getTopics(e);d.aB.isMobile()?1===e.page?t(r):t((e=>[...e,...r])):t(r),n(!1),s(!(!r||!r.length))}),[]),c=(0,a.useCallback)(((e,t,r)=>{let a="";if(e)a="精华";else if(r)a="置顶";else switch(t){case"share":a="分享";break;case"ask":a="问答";break;case"job":a="招聘";break;default:a="暂无"}return a}),[]),[l,u]=(0,a.useState)({id:"",author_id:"",tab:"",content:"",title:"",last_reply_at:"",good:!1,top:!1,reply_count:0,visit_count:0,create_at:"",author:{loginname:"",avatar_url:""},replies:[]}),[p,h]=(0,a.useState)(!1);return{topics:e,topicsLoading:i,getTopics:o,topicDetail:l,topicDetailLoading:p,getTopic:(0,a.useCallback)((e=>{h(!0),m.topicService.getTopic(e).then((e=>{u(e),h(!1)})).catch((()=>{h(!1)}))}),[]),getLabel:c,isMore:r}}},6071:function(e,t,r){"use strict";r.r(t);var a=r(7294);t.default=e=>{let{avatar:t,alt:r="图片",isRound:s=!1,size:i="default"}=e;return a.createElement("div",{className:`cms-avatar cms-avatar__${i} ${s?"is-round":""}`},a.createElement("img",{src:t,alt:r}))}},5756:function(e,t,r){"use strict";r.r(t);var a=r(7294);const s=(0,a.memo)((e=>{const{title:t,children:r,style:s,className:i}=e;return a.createElement("div",{className:`cms-module ${i||""}`,style:s},t&&a.createElement("div",{className:"cms-module__header "+("string"==typeof t?"is-bold":"")},t),a.createElement("div",{className:"cms-module__body"},r))}));t.default=s},4989:function(e,t,r){"use strict";r.r(t);var a=r(7294),s=r(9250),i=r(8349),n=r(5756),o=r(589),c=r(9655),l=r(1802),u=r(6071);t.default=()=>{const{id:e}=(0,s.UO)(),{getTopic:t,topicDetail:r,getLabel:m}=(0,i.B)();return(0,a.useEffect)((()=>{t(e)}),[e,t]),a.createElement("div",{className:"cms-layout__center"},a.createElement("div",{className:"cms-layout__left"},a.createElement(n.default,{className:"cms-topic"},a.createElement("div",{className:"cms-topic__header"},a.createElement("h1",{className:"title"},null==r?void 0:r.title),a.createElement("div",{className:"labels"},a.createElement("span",null,"发布于 ",o.Ye.timeAgo(r.create_at)),a.createElement("span",null,"作者",a.createElement(c.rU,{to:`/user/${r.author.loginname}`},r.author.loginname)),a.createElement("span",null," ",r.visit_count," 次浏览"),a.createElement("span",null,"来自",m(null==r?void 0:r.good,null==r?void 0:r.tab,null==r?void 0:r.top)))),a.createElement("div",{className:"cms-topic__body",dangerouslySetInnerHTML:{__html:null==r?void 0:r.content}})),r.replies.length?a.createElement(l.default,{replies:r.replies}):null),a.createElement("div",{className:"cms-layout__right"},a.createElement(n.default,{className:"cms-topic",title:"作者"},a.createElement(c.rU,{className:"user_card",to:`/user/${r.author.loginname}`},a.createElement(u.default,{avatar:r.author.avatar_url,alt:r.author.loginname,size:"large"}),a.createElement("span",{className:"user_name"},r.author.loginname)))))}},1802:function(e,t,r){"use strict";r.r(t);var a=r(7294),s=r(589),i=r(9655),n=r(5756),o=r(6071);t.default=e=>{let{replies:t}=e;return a.createElement(n.default,{className:"cms-reply",style:{marginTop:"15px"},title:`${t.length}　回复`},t.map(((e,t)=>a.createElement("div",{className:"cms-reply__item",key:e.id},a.createElement("div",{className:"card"},a.createElement(o.default,{size:"small",avatar:e.author.avatar_url,alt:e.author.loginname}),a.createElement("div",{className:"content"},a.createElement("div",{className:"user-info"},a.createElement(i.rU,{to:`/user/${e.author.loginname}`},e.author.loginname),a.createElement("span",{className:"reply-time"},`${t+1}楼 • ${s.Ye.timeAgo(e.create_at)}`)),a.createElement("div",{dangerouslySetInnerHTML:{__html:e.content}})))))))}},589:function(e,t,r){"use strict";r.d(t,{aB:function(){return a},oB:function(){return i},Ye:function(){return s}});const a={NAV:window.navigator,UA(){return this.NAV.userAgent.toLowerCase()},isIpad(){return/ipad/i.test(this.UA())},isIphone(){return/iphone/i.test(this.UA())},isIpod(){return/ipod/i.test(this.UA())},isIos(){return/ipad|iphone|ipod/i.test(this.UA())},isAndroid(){return/android/i.test(this.UA())},isIe(){return/(trident|microsoft)/i.test(this.NAV?this.NAV.appName:"")},isMobile(){return this.isIphone||this.isIos||this.isAndroid},isChrome(){return/chrome/i.test(this.UA())},isFirefox(){return/firefox/i.test(this.UA())},isOpera(){return/opera/i.test(this.UA())},isSafari(){return/safari/i.test(this.UA())},isEdge(){return/edge/i.test(this.UA())},isWechat(){return/micromessenger/i.test(this.UA())},isQqbrowser(){return/qqbrowser/i.test(this.UA())},isUcbrowser(){return/ucbrowser/i.test(this.UA())},isVideo(){return this.isChrome||this.isFirefox||this.isOpera||this.isSafari||this.isEdge},isCssVar(){return window.CSS&&window.CSS.supports&&window.CSS.supports("--a","0")}};window.localStorage,window.sessionStorage;r(4227);const s={timeAgo(e){if(!e)return"";var t=new Date(e),r=(new Date).getTime()-t.getTime();return r<0?"":r/1e3<30?"刚刚":r/1e3<60?parseInt(r/1e3+"")+"秒前":r/6e4<60?parseInt(r/6e4+"")+"分钟前":r/36e5<24?parseInt(r/36e5+"")+"小时前":r/864e5<31?parseInt(r/864e5+"")+"天前":r/2592e6<12?parseInt(r/2592e6+"")+"月前":parseInt(r/31536e6+"")+"年前"}},i={getScrollTop(){let e=0;return document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},getClientHeight(){let e=0;return e=document.body.clientHeight&&document.documentElement.clientHeight?Math.min(document.body.clientHeight,document.documentElement.clientHeight):Math.max(document.body.clientHeight,document.documentElement.clientHeight),e},getScrollHeight(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}},4227:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";const urlUtil={getUrlParam(e,t){let r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=(t||window.location.href).split("?").length>1&&(t||window.location.href).split("?")[1].match(r);return a?decodeURIComponent(a[2]):""},replaceParamVal(paramName,replaceWith,url){let oUrl=url||window.location.href,re=eval("/("+paramName+"=)([^&]*)/gi"),nUrl=oUrl.replace(re,paramName+"="+replaceWith);return nUrl}}},4654:function(){}}]);
//# sourceMappingURL=661.7e6ecd935b.chunk.js.map