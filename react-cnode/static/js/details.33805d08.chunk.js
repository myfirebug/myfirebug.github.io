(this["webpackJsonpreact-text"]=this["webpackJsonpreact-text"]||[]).push([[3],{154:function(e,t,n){"use strict";n(88);var r=n(34),o=n.n(r),a=n(157),i=n.n(a),c={development:{api:"https://cnodejs.org/api/v1"},production:{api:"https://cnodejs.org/api/v1"}},l=n(158),s=n.n(l),u=function(e){i.a.defaults.baseURL=c.production[e]};function f(e,t,n,r){return n&&u(n),new Promise((function(n,o){i.a.get(e,{params:t,header:r}).then((function(e){n(e)})).catch((function(e){o(e)}))}))}function d(e,t,n,r,o){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return n&&u(n),new Promise((function(n,c){i.a.post(e,a?s.a.stringify(t):t,{headers:r||{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}},o).then((function(e){n(e)})).catch((function(e){c(e)}))}))}i.a.defaults.timeout=6e4,i.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",i.a.interceptors.request.use((function(e){return o.a.loading("loading...",0),e}),(function(e){return Promise.error(e)})),i.a.interceptors.response.use((function(e){return o.a.hide(),200===e.status?Promise.resolve(e.data):Promise.reject(e)}),(function(e){o.a.hide();var t=e.response;if(!t)return Promise.reject(e);t.status;return Promise.reject(e)}));t.a={getTopics:function(e){return f("/topics",e,"api")},getDetails:function(e){return f("/topic/".concat(e),{},"api")},login:function(e){return d("/accesstoken",e,"api")},user:function(e){return f("/user/".concat(e),"","api")},collect:function(e){return d("/topic_collect/collect",e,"api")},de_collect:function(e){return d("/topic_collect/de_collect ",e,"api")},myCollect:function(e){return f("/topic_collect/".concat(e),"","api")},messages:function(e){return f("messages",e,"api")},markOne:function(e,t){return d("/message/mark_one/".concat(e),t,"api")}}},156:function(e,t,n){"use strict";function r(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.href.split("?").length>1&&window.location.href.split("?")[1].match(t);return n?decodeURIComponent(n[2]):null}function o(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var a=function(e){if(!e)return"";var t=new Date(e),n=(new Date).getTime()-t.getTime();return n<0?"":n/1e3<30?"\u521a\u521a":n/1e3<60?parseInt(n/1e3)+"\u79d2\u524d":n/6e4<60?parseInt(n/6e4)+"\u5206\u949f\u524d":n/36e5<24?parseInt(n/36e5)+"\u5c0f\u65f6\u524d":n/864e5<31?parseInt(n/864e5)+"\u5929\u524d":n/2592e6<12?parseInt(n/2592e6)+"\u6708\u524d":parseInt(n/31536e6)+"\u5e74\u524d"}},159:function(e,t,n){"use strict";var r=n(0),o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var a=function(e){var t=e.animate,n=e.backgroundColor,a=e.backgroundOpacity,i=e.baseUrl,c=e.children,l=e.foregroundColor,s=e.foregroundOpacity,u=e.gradientRatio,f=e.uniqueKey,d=e.interval,p=e.rtl,m=e.speed,h=e.style,v=e.title,b=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["animate","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","uniqueKey","interval","rtl","speed","style","title"]),y=f||Math.random().toString(36).substring(6),g=y+"-diff",E=y+"-animated-diff",O=y+"-aria",w=p?{transform:"scaleX(-1)"}:null,C="0; "+d+"; 1",_=m+"s";return Object(r.createElement)("svg",o({"aria-labelledby":O,role:"img",style:o(o({},h),w)},b),v?Object(r.createElement)("title",{id:O},v):null,Object(r.createElement)("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%",clipPath:"url("+i+"#"+g+")",style:{fill:"url("+i+"#"+E+")"}}),Object(r.createElement)("defs",{role:"presentation"},Object(r.createElement)("clipPath",{id:g},c),Object(r.createElement)("linearGradient",{id:E},Object(r.createElement)("stop",{offset:"0%",stopColor:n,stopOpacity:a},t&&Object(r.createElement)("animate",{attributeName:"offset",values:-u+"; "+-u+"; 1",keyTimes:C,dur:_,repeatCount:"indefinite"})),Object(r.createElement)("stop",{offset:"50%",stopColor:l,stopOpacity:s},t&&Object(r.createElement)("animate",{attributeName:"offset",values:-u/2+"; "+-u/2+"; "+(1+u/2),keyTimes:C,dur:_,repeatCount:"indefinite"})),Object(r.createElement)("stop",{offset:"100%",stopColor:n,stopOpacity:a},t&&Object(r.createElement)("animate",{attributeName:"offset",values:"0; 0; "+(1+u),keyTimes:C,dur:_,repeatCount:"indefinite"})))))};a.defaultProps={animate:!0,backgroundColor:"#f5f6f7",backgroundOpacity:1,baseUrl:"",foregroundColor:"#eee",foregroundOpacity:1,gradientRatio:2,id:null,interval:.25,rtl:!1,speed:1.2,style:{},title:"Loading..."};var i=function(e){return e.children?Object(r.createElement)(a,o({},e)):Object(r.createElement)(c,o({},e))},c=function(e){return Object(r.createElement)(i,o({viewBox:"0 0 476 124"},e),Object(r.createElement)("rect",{x:"48",y:"8",width:"88",height:"6",rx:"3"}),Object(r.createElement)("rect",{x:"48",y:"26",width:"52",height:"6",rx:"3"}),Object(r.createElement)("rect",{x:"0",y:"56",width:"410",height:"6",rx:"3"}),Object(r.createElement)("rect",{x:"0",y:"72",width:"380",height:"6",rx:"3"}),Object(r.createElement)("rect",{x:"0",y:"88",width:"178",height:"6",rx:"3"}),Object(r.createElement)("circle",{cx:"20",cy:"20",r:"20"}))};t.a=i},162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forceVisible=t.forceCheck=t.lazyload=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=d(o),i=d(n(14)),c=d(n(1)),l=n(163),s=d(n(164)),u=d(n(165)),f=d(n(166));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=0,b=0,y=0,g=0,E="data-lazyload-listened",O=[],w=[],C=!1;try{var _=Object.defineProperty({},"passive",{get:function(){C=!0}});window.addEventListener("test",null,_)}catch(T){}var j=!!C&&{capture:!1,passive:!0},k=function(e){var t=i.default.findDOMNode(e);if(t instanceof HTMLElement){var n=(0,s.default)(t);(e.props.overflow&&n!==t.ownerDocument&&n!==document&&n!==document.documentElement?function(e,t){var n=i.default.findDOMNode(e),r=void 0,o=void 0,a=void 0,c=void 0;try{var l=t.getBoundingClientRect();r=l.top,o=l.left,a=l.height,c=l.width}catch(T){r=v,o=b,a=g,c=y}var s=window.innerHeight||document.documentElement.clientHeight,u=window.innerWidth||document.documentElement.clientWidth,f=Math.max(r,0),d=Math.max(o,0),p=Math.min(s,r+a)-f,m=Math.min(u,o+c)-d,h=void 0,E=void 0,O=void 0,w=void 0;try{var C=n.getBoundingClientRect();h=C.top,E=C.left,O=C.height,w=C.width}catch(T){h=v,E=b,O=g,w=y}var _=h-f,j=E-d,k=Array.isArray(e.props.offset)?e.props.offset:[e.props.offset,e.props.offset];return _-k[0]<=p&&_+O+k[1]>=0&&j-k[0]<=m&&j+w+k[1]>=0}(e,n):function(e){var t=i.default.findDOMNode(e);if(!(t.offsetWidth||t.offsetHeight||t.getClientRects().length))return!1;var n=void 0,r=void 0;try{var o=t.getBoundingClientRect();n=o.top,r=o.height}catch(T){n=v,r=g}var a=window.innerHeight||document.documentElement.clientHeight,c=Array.isArray(e.props.offset)?e.props.offset:[e.props.offset,e.props.offset];return n-c[0]<=a&&n+r+c[1]>=0}(e))?e.visible||(e.props.once&&w.push(e),e.visible=!0,e.forceUpdate()):e.props.once&&e.visible||(e.visible=!1,e.props.unmountIfInvisible&&e.forceUpdate())}},x=function(){w.forEach((function(e){var t=O.indexOf(e);-1!==t&&O.splice(t,1)})),w=[]},N=function(){for(var e=0;e<O.length;++e){var t=O[e];k(t)}x()},M=void 0,I=null,D=function(e){function t(e){p(this,t);var n=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.visible=!1,n}return h(t,e),r(t,[{key:"componentDidMount",value:function(){var e=window,t=this.props.scrollContainer;t&&"string"===typeof t&&(e=e.document.querySelector(t));var n=void 0!==this.props.debounce&&"throttle"===M||"debounce"===M&&void 0===this.props.debounce;if(n&&((0,l.off)(e,"scroll",I,j),(0,l.off)(window,"resize",I,j),I=null),I||(void 0!==this.props.debounce?(I=(0,u.default)(N,"number"===typeof this.props.debounce?this.props.debounce:300),M="debounce"):void 0!==this.props.throttle?(I=(0,f.default)(N,"number"===typeof this.props.throttle?this.props.throttle:300),M="throttle"):I=N),this.props.overflow){var r=(0,s.default)(i.default.findDOMNode(this));if(r&&"function"===typeof r.getAttribute){var o=+r.getAttribute(E)+1;1===o&&r.addEventListener("scroll",I,j),r.setAttribute(E,o)}}else if(0===O.length||n){var a=this.props,c=a.scroll,d=a.resize;c&&(0,l.on)(e,"scroll",I,j),d&&(0,l.on)(window,"resize",I,j)}O.push(this),k(this)}},{key:"shouldComponentUpdate",value:function(){return this.visible}},{key:"componentWillUnmount",value:function(){if(this.props.overflow){var e=(0,s.default)(i.default.findDOMNode(this));if(e&&"function"===typeof e.getAttribute){var t=+e.getAttribute(E)-1;0===t?(e.removeEventListener("scroll",I,j),e.removeAttribute(E)):e.setAttribute(E,t)}}var n=O.indexOf(this);-1!==n&&O.splice(n,1),0===O.length&&"undefined"!==typeof window&&((0,l.off)(window,"resize",I,j),(0,l.off)(window,"scroll",I,j))}},{key:"render",value:function(){return this.visible?this.props.children:this.props.placeholder?this.props.placeholder:a.default.createElement("div",{style:{height:this.props.height},className:"lazyload-placeholder"})}}]),t}(o.Component);D.propTypes={once:c.default.bool,height:c.default.oneOfType([c.default.number,c.default.string]),offset:c.default.oneOfType([c.default.number,c.default.arrayOf(c.default.number)]),overflow:c.default.bool,resize:c.default.bool,scroll:c.default.bool,children:c.default.node,throttle:c.default.oneOfType([c.default.number,c.default.bool]),debounce:c.default.oneOfType([c.default.number,c.default.bool]),placeholder:c.default.node,scrollContainer:c.default.oneOfType([c.default.string,c.default.object]),unmountIfInvisible:c.default.bool},D.defaultProps={once:!1,offset:0,overflow:!1,resize:!1,scroll:!0,unmountIfInvisible:!1};var P=function(e){return e.displayName||e.name||"Component"};t.lazyload=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return function(n){function o(){p(this,o);var e=m(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.displayName="LazyLoad"+P(t),e}return h(o,n),r(o,[{key:"render",value:function(){return a.default.createElement(D,e,a.default.createElement(t,this.props))}}]),o}(o.Component)}},t.default=D,t.forceCheck=N,t.forceVisible=function(){for(var e=0;e<O.length;++e){var t=O[e];t.visible=!0,t.forceUpdate()}x()}},163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.on=function(e,t,n,r){r=r||!1,e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,(function(t){n.call(e,t||window.event)}))},t.off=function(e,t,n,r){r=r||!1,e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n)}},164:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!(e instanceof HTMLElement))return document.documentElement;for(var t="absolute"===e.style.position,n=/(scroll|auto)/,r=e;r;){if(!r.parentNode)return e.ownerDocument||document.documentElement;var o=window.getComputedStyle(r),a=o.position,i=o.overflow,c=o["overflow-x"],l=o["overflow-y"];if("static"===a&&t)r=r.parentNode;else{if(n.test(i)&&n.test(c)&&n.test(l))return r;r=r.parentNode}}return e.ownerDocument||e.documentElement||document.documentElement}},165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=void 0,o=void 0,a=void 0,i=void 0,c=void 0,l=function l(){var s=+new Date-i;s<t&&s>=0?r=setTimeout(l,t-s):(r=null,n||(c=e.apply(a,o),r||(a=null,o=null)))};return function(){a=this,o=arguments,i=+new Date;var s=n&&!r;return r||(r=setTimeout(l,t)),s&&(c=e.apply(a,o),a=null,o=null),c}}},166:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r,o;return t||(t=250),function(){var a=n||this,i=+new Date,c=arguments;r&&i<r+t?(clearTimeout(o),o=setTimeout((function(){r=i,e.apply(a,c)}),t)):(r=i,e.apply(a,c))}}},168:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));n(88);var r=n(34),o=n.n(r),a=n(4),i=n(154),c=function(e){return{type:a.i,flag:e}},l=function(e){return function(t,n){n().details.is_collect?i.a.de_collect(e).then((function(){t(c(!1)),o.a.success("\u53d6\u6d88\u6536\u85cf\u6210\u529f",1.5)})):i.a.collect(e).then((function(){t(c(!0)),o.a.success("\u6536\u85cf\u6210\u529f",1.5)}))}},s=function(e){return function(t){i.a.myCollect(e).then((function(e){var n;e.success&&t((n=e.data,{type:a.a,data:n}))}))}}},202:function(e,t,n){},203:function(e,t,n){},210:function(e,t,n){"use strict";n.r(t);n(88);var r=n(34),o=n.n(r),a=n(0),i=n.n(a),c=n(35),l=n(156),s=n(4),u=n(154),f=n(168),d=(n(202),n(203),n(162)),p=n.n(d),m=n(48),h=function(e){var t=e.id,n=e.number,r=e.author,c=r.avatar_url,s=r.loginname,u=e.create_at,f=e.content,d=e.userInfo,h=e.ups,v=e.setOrCancelCommentLike,b=e.setCommentDelete,y=Object(a.useCallback)((function(e){switch(e){case"delete":b({userId:d.id,replayId:t});break;case"like":v({userId:d.id,replayId:t});break;case"edit":case"reply":o.a.info("\u529f\u80fd\u6b63\u5728\u5f00\u53d1\u4e2d",1.5)}}),[]);return i.a.createElement("li",{className:"cn-replay__item ui-border-b"},i.a.createElement(m.b,{to:{pathname:"/my",search:"username=".concat(s)}},i.a.createElement("div",{className:"author_content"},i.a.createElement("div",{className:"user-avatar"},i.a.createElement(p.a,null,i.a.createElement("img",{src:c,alt:""}))),i.a.createElement("div",{className:"user-info"},i.a.createElement("span",{className:"user-name"},s),i.a.createElement("span",{className:"reply-time"},n,"\u697c\u2022",Object(l.c)(u))))),i.a.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:"".concat(f)}}),d.id&&d.token&&i.a.createElement("div",{className:"operation"},d.loginname===s&&d.token?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{onClick:function(){return y("delete")}},i.a.createElement("i",{className:"ued-mobile"},"\ue78c"),"\u5220\u9664"),i.a.createElement("span",{onClick:function(){return y("edit")}},i.a.createElement("i",{className:"ued-mobile"},"\ue6b9"),"\u7f16\u8f91")):null,i.a.createElement("span",{onClick:function(){return y("like")}},i.a.createElement("i",{className:"ued-mobile"},"\ue643"),-1!==h.indexOf(d.id)?"\u53d6\u6d88":"","\u70b9\u8d5e(",h.length,")"),i.a.createElement("span",{onClick:function(){return y("reply")}},i.a.createElement("i",{className:"ued-mobile"},"\ue6f9"),"\u56de\u590d")))},v=Object(a.memo)((function(e){var t=e.list,n=e.userInfo,r=e.setOrCancelCommentLike,o=e.setCommentDelete;return i.a.createElement("div",{className:"cn-replay__list"},t.map((function(e,t){return i.a.createElement(h,Object.assign({userInfo:n,setOrCancelCommentLike:r,setCommentDelete:o,number:t,key:e.id},e))})))})),b=Object(a.memo)((function(e){return i.a.createElement("div",{className:"cn-replay"},i.a.createElement("div",{className:"cn-replay__hd ui-border-tb"},"\u5171",e.list.length,"\u6761\u56de\u590d"),i.a.createElement("div",{className:"cn-replay__bd"},i.a.createElement(v,e)))})),y=n(159),g=function(){return i.a.createElement("div",{style:{padding:".3rem"}},i.a.createElement(y.a,{width:"100%",speed:1,backgroundColor:"#eee",foregroundColor:"#f5f5f5",viewBox:"0 0 380 342"},i.a.createElement("rect",{x:"0",y:"8",width:"100%",height:"12",rx:"6"}),i.a.createElement("rect",{x:"0",y:"26",width:"140",height:"12",rx:"6"}),i.a.createElement("rect",{x:"0",y:"60",width:"300",height:"6",rx:"3"}),i.a.createElement("rect",{x:"0",y:"90",width:"380",height:"0.5",rx:"1"}),i.a.createElement("rect",{x:"0",y:"110",width:"380",height:"200",rx:"5"}),i.a.createElement("rect",{x:"0",y:"320",width:"380",height:"6",rx:"3"}),i.a.createElement("rect",{x:"0",y:"336",width:"100",height:"6",rx:"3"})))},E=Object(a.memo)((function(e){var t=e.details,n=e.getDetails,r=e.userInfo,c=e.setOrCancelCommentLike,s=e.setCommentDelete,u=e.setOrCancelCollect;Object(a.useEffect)((function(){n(Object(l.b)("id"))}),[n]);var f=Object(a.useCallback)((function(e){switch(e){case"comments":o.a.info("\u529f\u80fd\u6b63\u5728\u5f00\u53d1\u4e2d");break;case"collection":u({accesstoken:r.token,topic_id:t.id})}}),[t,r]);return i.a.createElement(i.a.Fragment,null,"{}"!==JSON.stringify(t)?i.a.createElement("div",{className:"cn-details"},i.a.createElement("div",{className:"cn-details__hd ui-border-b"},i.a.createElement("h1",{className:"title"},t.title),i.a.createElement("div",{className:"info"},i.a.createElement("span",null,i.a.createElement("i",{className:"ued-mobile"},"\ue666"),t.reply_count),i.a.createElement("span",null,i.a.createElement("i",{className:"ued-mobile"},"\ue637"),t.visit_count),i.a.createElement("span",null,i.a.createElement("i",{className:"ued-mobile"},"\ue78b"),Object(l.a)(new Date(t.last_reply_at),"yyyy-MM-dd hh:ss:mm")))),i.a.createElement("div",{className:"cn-details__bd",dangerouslySetInnerHTML:{__html:"".concat(t.content)}}),t.replies&&t.replies.length&&i.a.createElement(b,{setCommentDelete:s,setOrCancelCommentLike:c,list:t.replies,userInfo:r}),r.token&&r.id?i.a.createElement("div",{className:"cn-details__ft"},i.a.createElement("span",{className:"comments",onClick:function(){return f("comments")}},"\u8bc4\u8bba"),i.a.createElement("span",{className:"collection",onClick:function(){return f("collection")}},t.is_collect?"\u53d6\u6d88":"","\u6536\u85cf")):null):i.a.createElement(g,null))}));t.default=Object(c.b)((function(e){return{details:e.details,userInfo:e.userInfo}}),{getDetails:function(e){return function(t){u.a.getDetails(e).then((function(e){var n;t((n=e.data,{type:s.d,data:n}))}))}},setOrCancelCommentLike:function(e){return function(t){var n;t((n=e,{type:s.c,payload:n}))}},setCommentDelete:function(e){return function(t){var n;t((n=e,{type:s.b,payload:n}))}},setOrCancelCollect:f.b})(E)}}]);
//# sourceMappingURL=details.33805d08.chunk.js.map